---
---

<section id="problem" class="relative py-[var(--spacing-section-desktop)] max-md:py-[var(--spacing-section-mobile)] overflow-hidden">
  <div class="container-content">
    <div class="grid md:grid-cols-2 gap-16 items-center">
      <!-- Text content -->
      <div class="problem-text">
        <p class="text-sm font-mono text-orange-primary mb-4 tracking-wider uppercase" data-problem-reveal>
          The Reality
        </p>
        <h2 class="text-heading mb-6" data-problem-reveal>
          Your morning starts with
          <span class="stat-counter font-mono text-orange-primary" data-count-to="47">0</span>
          unread notifications.
        </h2>
        <p class="text-body text-text-secondary mb-6" data-problem-reveal>
          Context switching. Missed deadlines. Scattered across 12 different apps.
          Your day is fragmented before it even begins.
        </p>
        <p class="text-body text-text-secondary" data-problem-reveal>
          You are not lazy. Your tools are just working against you.
        </p>
      </div>

      <!-- Chaos illustration -->
      <div class="chaos-visual relative" aria-hidden="true" data-chaos-container>
        <div class="chaos-card glass" data-chaos style="--delay: 0;">
          <div class="flex items-center gap-2">
            <div class="w-6 h-6 rounded bg-red-500/20 flex items-center justify-center">
              <span class="text-xs">!</span>
            </div>
            <span class="text-xs text-text-secondary">Urgent: Q4 report</span>
          </div>
        </div>
        <div class="chaos-card glass" data-chaos style="--delay: 1;">
          <div class="flex items-center gap-2">
            <div class="w-6 h-6 rounded bg-blue-500/20 flex items-center justify-center">
              <span class="text-xs">@</span>
            </div>
            <span class="text-xs text-text-secondary">3 mentions in #design</span>
          </div>
        </div>
        <div class="chaos-card glass" data-chaos style="--delay: 2;">
          <div class="flex items-center gap-2">
            <div class="w-6 h-6 rounded bg-yellow-500/20 flex items-center justify-center">
              <span class="text-xs">&#9993;</span>
            </div>
            <span class="text-xs text-text-secondary">12 unread emails</span>
          </div>
        </div>
        <div class="chaos-card glass" data-chaos style="--delay: 3;">
          <div class="flex items-center gap-2">
            <div class="w-6 h-6 rounded bg-purple-500/20 flex items-center justify-center">
              <span class="text-xs">&#128276;</span>
            </div>
            <span class="text-xs text-text-secondary">Sprint review in 15min</span>
          </div>
        </div>
        <div class="chaos-card glass" data-chaos style="--delay: 4;">
          <div class="flex items-center gap-2">
            <div class="w-6 h-6 rounded bg-green-500/20 flex items-center justify-center">
              <span class="text-xs">&#10003;</span>
            </div>
            <span class="text-xs text-text-secondary">PR needs review</span>
          </div>
        </div>
        <div class="chaos-card glass" data-chaos style="--delay: 5;">
          <div class="flex items-center gap-2">
            <div class="w-6 h-6 rounded bg-orange-500/20 flex items-center justify-center">
              <span class="text-xs">&#9888;</span>
            </div>
            <span class="text-xs text-text-secondary">Deploy failed</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .chaos-visual {
    min-height: 350px;
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    align-items: center;
    justify-content: center;
    position: relative;
  }

  .chaos-card {
    padding: 12px 16px;
    white-space: nowrap;
    opacity: 0;
  }

  @media (max-width: 768px) {
    .chaos-visual {
      min-height: 250px;
    }
  }
</style>

<script>
  import { scrollStagger, registerGSAP, prefersReducedMotion } from "@/utils/animations";
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  registerGSAP();

  if (!prefersReducedMotion()) {
    // Counter animation
    const counter = document.querySelector(".stat-counter") as HTMLElement;
    if (counter) {
      const target = parseInt(counter.dataset.countTo || "0", 10);
      ScrollTrigger.create({
        trigger: "#problem",
        start: "top 70%",
        once: true,
        onEnter: () => {
          gsap.to(counter, {
            innerText: target,
            duration: 2,
            ease: "power2.out",
            snap: { innerText: 1 },
            onUpdate() {
              counter.textContent = Math.round(
                parseFloat(counter.textContent || "0"),
              ).toString();
            },
          });
        },
      });
    }

    // Text reveal stagger — uses animation utility
    scrollStagger("[data-problem-reveal]", {
      trigger: "#problem" as unknown as Element,
      stagger: 0.15,
    });

    // Chaos cards scatter in (unique animation — not a generic utility pattern)
    const chaosCards = document.querySelectorAll("[data-chaos]");
    chaosCards.forEach((card, i) => {
      const randomX = (Math.random() - 0.5) * 200;
      const randomY = (Math.random() - 0.5) * 200;
      const randomRotation = (Math.random() - 0.5) * 30;

      gsap.fromTo(
        card,
        {
          opacity: 0,
          x: randomX,
          y: randomY,
          rotation: randomRotation,
          scale: 0.8,
        },
        {
          scrollTrigger: {
            trigger: "#problem",
            start: "top 60%",
          },
          opacity: 1,
          x: (Math.random() - 0.5) * 40,
          y: (Math.random() - 0.5) * 40,
          rotation: (Math.random() - 0.5) * 8,
          scale: 1,
          duration: 1,
          delay: i * 0.12,
          ease: "power3.out",
        },
      );

      // Continuous floating
      gsap.to(card, {
        y: `+=${8 + Math.random() * 8}`,
        x: `+=${(Math.random() - 0.5) * 6}`,
        rotation: `+=${(Math.random() - 0.5) * 3}`,
        duration: 3 + Math.random() * 2,
        repeat: -1,
        yoyo: true,
        ease: "sine.inOut",
        delay: i * 0.2,
      });
    });
  } else {
    // Show cards immediately for reduced motion
    document.querySelectorAll("[data-chaos]").forEach((card) => {
      (card as HTMLElement).style.opacity = "1";
    });
    const counter = document.querySelector(".stat-counter") as HTMLElement;
    if (counter) counter.textContent = counter.dataset.countTo || "47";
  }
</script>
